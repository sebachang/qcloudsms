(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57d2d8b1"],{4678:function(e,t,a){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"73332","./en-il.js":"73332","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df48","./fa.js":"8df48","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b46","./gd.js":"f6b46","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=l(e);return a(t)}function l(e){var t=s[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}n.keys=function(){return Object.keys(s)},n.resolve=l,e.exports=n,n.id="4678"},"8f1a":function(e,t,a){"use strict";a.d(t,"d",function(){return n}),a.d(t,"e",function(){return l}),a.d(t,"c",function(){return r}),a.d(t,"b",function(){return o}),a.d(t,"a",function(){return i}),a.d(t,"h",function(){return c}),a.d(t,"f",function(){return u}),a.d(t,"g",function(){return d});var s=a("d0f7");function n(e){return Object(s["a"])({url:"./task/taskinstance/"+e+"/",method:"get"})}function l(e){return Object(s["a"])({url:"./task/taskinstance/",method:"get",params:e})}function r(e){return Object(s["a"])({url:"./task/job/",method:"get",params:e})}function o(e){return Object(s["a"])({url:"./task/job/"+e+"/",method:"delete"})}function i(e){return Object(s["a"])({url:"./task/job/",method:"post",data:e})}function c(e,t){return Object(s["a"])({url:"./task/job/"+e+"/",method:"put",data:t})}function u(e){return Object(s["a"])({url:"./task/log/"+e+"/",method:"get"})}function d(e){return Object(s["a"])({url:"./task/register/",method:"post",data:e})}},"8f5e":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"table-head-container"},[a("div",{staticStyle:{float:"left"},attrs:{align:"left"}},[e._e(),e._v(" "),e._e(),e._v(" "),a("p",{staticStyle:{"padding-left":"20px",display:"inline","font-size":"13px",color:"#999"}},[e._v(e._s(e.currentTotal)+"个中\n        "+e._s(e.multipleSelectionCount)+" 个被选中")])],1),e._v(" "),a("div",{staticClass:"right-menu",attrs:{align:"right"}},[a("div",{staticClass:"header-search",class:{show:e.show}},[a("svg-icon",{attrs:{"class-name":"search-icon","icon-class":"search"},on:{click:function(t){return t.stopPropagation(),e.click(t)}}}),e._v(" "),a("el-input",{ref:"headerSearchSelect",staticClass:"header-search-select",attrs:{placeholder:"搜索"},model:{value:e.search_value,callback:function(t){e.search_value=t},expression:"search_value"}})],1),e._v(" "),a("el-button",{staticClass:"header-refresh",attrs:{icon:"el-icon-refresh",circle:""},on:{click:e.handleRefresh}}),e._v(" "),a("el-dropdown",{staticStyle:{bottom:"5px"},attrs:{"hide-on-click":!1}},[a("el-button",{staticClass:"header-outline",attrs:{icon:"el-icon-more-outline",circle:""}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.id,callback:function(t){e.$set(e.column_rules,"id",t)},expression:"column_rules.id"}},[e._v("ID")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.job_name,callback:function(t){e.$set(e.column_rules,"job_name",t)},expression:"column_rules.job_name"}},[e._v("任务名")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.name,callback:function(t){e.$set(e.column_rules,"name",t)},expression:"column_rules.name"}},[e._v("实例名")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.user,callback:function(t){e.$set(e.column_rules,"user",t)},expression:"column_rules.user"}},[e._v("提交者")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.is_finished,callback:function(t){e.$set(e.column_rules,"is_finished",t)},expression:"column_rules.is_finished"}},[e._v("完成状态")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.status,callback:function(t){e.$set(e.column_rules,"status",t)},expression:"column_rules.status"}},[e._v("执行状态")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.create_time,callback:function(t){e.$set(e.column_rules,"create_time",t)},expression:"column_rules.create_time"}},[e._v("创建时间")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.start_time,callback:function(t){e.$set(e.column_rules,"start_time",t)},expression:"column_rules.start_time"}},[e._v("启动时间")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.end_time,callback:function(t){e.$set(e.column_rules,"end_time",t)},expression:"column_rules.end_time"}},[e._v("完成时间")])],1),e._v(" "),a("el-dropdown-item",[a("el-checkbox",{model:{value:e.column_rules.total_time,callback:function(t){e.$set(e.column_rules,"total_time",t)},expression:"column_rules.total_time"}},[e._v("总耗时")])],1)],1)],1)],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"datatable",border:"",data:e.tableData,"header-cell-style":{background:"#f2f2f2",padding:"10px 0 10px 5px",color:"#666","font-size":"14px","font-weight":400},"cell-style":{padding:"7px 0 7px 5px",color:"#666","font-size":"14px","font-weight":400}},on:{"sort-change":e.sortChange,"filter-change":e.handleFilterChange,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"48"}}),e._v(" "),e.column_rules.id?a("el-table-column",{attrs:{sortable:"",prop:"id",label:"ID",width:"70"}}):e._e(),e._v(" "),e.column_rules.job_name?a("el-table-column",{attrs:{prop:"job_name",label:"任务名",width:"140"}}):e._e(),e._v(" "),e.column_rules.name?a("el-table-column",{attrs:{prop:"name",label:"实例名",width:"300"}}):e._e(),e._v(" "),e.column_rules.user?a("el-table-column",{attrs:{prop:"user",label:"提交者",width:"100"}}):e._e(),e._v(" "),e.column_rules.is_finished?a("el-table-column",{attrs:{prop:"is_finished",label:"完成状态",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[!1===t.row.is_finished?a("span",{staticStyle:{color:"green","font-size":"150%"}},[a("i",{staticClass:"el-icon-loading"})]):a("span",[e._v("是")])]}}],null,!1,1825097507)}):e._e(),e._v(" "),e.column_rules.status?a("el-table-column",{attrs:{formatter:e.formatStatus,prop:"status",label:"执行状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[3===t.row.status?a("span",{staticStyle:{color:"#37B328"}},[e._v("执行成功")]):1===t.row.status?a("span",{staticStyle:{color:"#1f33ff"}},[e._v("未执行")]):2===t.row.status?a("span",{staticStyle:{color:"#a9ffff"}},[e._v("正在执行")]):5===t.row.status?a("span",{staticStyle:{color:"#ff959f"}},[e._v("跳过")]):6===t.row.status?a("span",{staticStyle:{color:"#ff4ca9"}},[e._v("忽略错误")]):7===t.row.status?a("span",{staticStyle:{color:"#9092ff"}},[e._v("等待用户")]):8===t.row.status?a("span",{staticStyle:{color:"#ff782b"}},[e._v("手动结束")]):9===t.row.status?a("span",{staticStyle:{color:"#ff3a3d"}},[e._v("状态异常")]):10===t.row.status?a("span",{staticStyle:{color:"#ff0c6b"}},[e._v("步骤强制终止中")]):11===t.row.status?a("span",{staticStyle:{color:"#c119ff"}},[e._v("步骤强制终止成功")]):12===t.row.status?a("span",{staticStyle:{color:"red"}},[e._v("步骤强制终止失败")]):a("span",{staticStyle:{color:"red"}},[e._v("执行失败")])]}}],null,!1,3452523099)}):e._e(),e._v(" "),e.column_rules.create_time?a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"180"}}):e._e(),e._v(" "),e.column_rules.start_time?a("el-table-column",{attrs:{prop:"start_time",label:"启动时间",width:"180"}}):e._e(),e._v(" "),e.column_rules.end_time?a("el-table-column",{attrs:{prop:"end_time",label:"完成时间",width:"180"}}):e._e(),e._v(" "),e.column_rules.total_time?a("el-table-column",{attrs:{prop:"total_time",label:"总耗时(s)"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-view"},on:{click:function(a){return e.handleOpen(t)}}},[e._v("查看详情")])]}}])})],1),e._v(" "),a("div",{staticStyle:{height:"50px","margin-bottom":"10px",padding:"10px","line-height":"22px","border-radius":"0 0 4px 4px","border-color":"#dfe6ec","border-width":"0 1px 1px 1px","border-style":"solid"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, sizes, total, jumper","current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":e.pageSize,total:e.currentTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("TaskDetails",{ref:"task_details",attrs:{"auto-refresh":!0},on:{dataRefresh:e.handleRefresh}})],1)},n=[],l=a("cebc"),r=(a("c5f6"),a("8f1a")),o=(a("09ac"),a("2f62")),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,title:e.tasktitle,"append-to-body":e.appendToBody,"modal-append-to-body":e.modalAppendToBody},on:{"update:visible":function(t){e.dialogVisible=t},open:e.handleDialogOpen,close:e.handleDialogClose}},[a("div",{staticStyle:{height:"500px",width:"auto"}},["执行成功"===e.jobRow.status?a("el-progress",{attrs:{percentage:100,status:"success"}}):"执行失败"===e.jobRow.status?a("el-progress",{attrs:{percentage:100,status:"exception"}}):a("el-progress",{attrs:{percentage:50}}),e._v(" "),a("div",{staticStyle:{"margin-top":"10px",padding:"5px","line-height":"22px","border-radius":"0 2px 2px 0"}},[a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:10}},[a("div",[a("el-input",{attrs:{disabled:!0},model:{value:e.jobRow.job_name,callback:function(t){e.$set(e.jobRow,"job_name",t)},expression:"jobRow.job_name"}},[a("template",{slot:"prepend"},[e._v("名字")])],2)],1)]),e._v(" "),a("el-col",{attrs:{span:7}},[a("div",[a("el-input",{attrs:{disabled:!0},model:{value:e.jobRow.user,callback:function(t){e.$set(e.jobRow,"user",t)},expression:"jobRow.user"}},[a("template",{slot:"prepend"},[e._v("账户")])],2)],1)]),e._v(" "),a("el-col",{attrs:{span:7}},[a("div",[a("el-input",{attrs:{disabled:!0},model:{value:e.jobRow.total_time,callback:function(t){e.$set(e.jobRow,"total_time",t)},expression:"jobRow.total_time"}},[a("template",{slot:"prepend"},[e._v("总时间(s)")])],2)],1)])],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"5px"},attrs:{gutter:5}},[a("el-col",{attrs:{span:5}},[a("div",[a("el-input",{attrs:{disabled:!0},model:{value:e.jobRow.start_way,callback:function(t){e.$set(e.jobRow,"start_way",t)},expression:"jobRow.start_way"}},[a("template",{slot:"prepend"},[e._v("调用")])],2)],1)]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",[a("el-input",{attrs:{disabled:!0},model:{value:e.jobRow.status,callback:function(t){e.$set(e.jobRow,"status",t)},expression:"jobRow.status"}},[a("template",{slot:"prepend"},[e._v("状态")])],2)],1)]),e._v(" "),a("el-col",{attrs:{span:7}},[a("div",[a("el-input",{attrs:{disabled:!0},model:{value:e.jobRow.start_time,callback:function(t){e.$set(e.jobRow,"start_time",t)},expression:"jobRow.start_time"}},[a("template",{slot:"prepend"},[e._v("开始")])],2)],1)]),e._v(" "),a("el-col",{attrs:{span:7}},[a("div",[a("el-input",{attrs:{disabled:!0},model:{value:e.jobRow.end_time,callback:function(t){e.$set(e.jobRow,"end_time",t)},expression:"jobRow.end_time"}},[a("template",{slot:"prepend"},[e._v("结束")])],2)],1)])],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px",padding:"5px","line-height":"22px","border-radius":"0 2px 2px 0"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-tabs",{ref:"jobInstanceTabe",attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"成功"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                成功\n                "),a("el-badge",{staticClass:"item",attrs:{value:e.currentTotalSuccess,size:"mini",type:"primary"}})],1),e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.jobInstanceData.success.slice((e.currentPageSuccess-1)*e.pageSizeSuccess,e.currentPageSuccess*e.pageSizeSuccess),border:"","highlight-current-row":""},on:{"current-change":e.handleSuccessTableCurrentChange}},[a("el-table-column",{attrs:{prop:"ip",label:"IP",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"exit_code",label:"返回码",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total_time",label:"耗时"}})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"",layout:"prev, pager, next, sizes, total, jumper","current-page":e.currentPageSuccess,"page-sizes":[5],"page-size":e.pageSizeSuccess,total:e.currentTotalSuccess},on:{"size-change":e.handleSuccessSizeChange,"current-change":e.handleSuccessCurrentChange}})],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"失败"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                失败\n                "),a("el-badge",{staticClass:"item",attrs:{value:e.currentTotalFailure,size:"mini"}})],1),e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.jobInstanceData.failure.slice((e.currentPageFailure-1)*e.pageSizeFailure,e.currentPageFailure*e.pageSizeFailure),border:"","highlight-current-row":""},on:{"current-change":e.handleFailureTableCurrentChange}},[a("el-table-column",{attrs:{prop:"ip",label:"IP",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"exit_code",label:"返回码",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total_time",label:"耗时"}})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"",layout:"prev, pager, next, sizes, total, jumper","current-page":e.currentPageFailure,"page-sizes":[5],"page-size":e.pageSizeFailure,total:e.currentTotalFailure},on:{"size-change":e.handleFailureSizeChange,"current-change":e.handleFailureCurrentChange}})],1)])],1)],1),e._v(" "),a("div",[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",rows:18,disabled:!0},model:{value:e.jobInstanceLog,callback:function(t){e.jobInstanceLog=t},expression:"jobInstanceLog"}})],1)],1)],1)],1)],1)])},c=[],u=a("5d73"),d=a.n(u),b=(a("7f7f"),a("5176")),h=a.n(b),f={id:-1,job_name:"",name:"",user:"",is_finished:"",status:"",create_time:"",start_time:"",end_time:"",total_time:""},p={name:"TaskDetails",props:{autoRefresh:{type:Boolean,default:!1},refreshInterval:{type:Number,default:12e3},appendToBody:{type:Boolean,default:!1},modalAppendToBody:{type:Boolean,default:!1}},computed:Object(l["a"])({},Object(o["b"])(["currBiz"])),created:function(){clearInterval(this.timer),this.timer=null,this.setTimer()},data:function(){return{timer:null,init:!1,dialogVisible:!1,jobInstanceLog:"",jobInstanceData:{success:[],failure:[]},currentPageSuccess:1,pageSizeSuccess:5,currentTotalSuccess:0,currentPageFailure:1,pageSizeFailure:5,currentTotalFailure:0,tasktitle:"任务详情",jobRow:h()({},f)}},methods:{setTimer:function(){var e=this;null==this.timer&&(this.timer=setInterval(function(){e.autoRefresh&&!0!==e.jobRow.is_finished&&!0===e.init&&-1!==e.jobRow.id&&(e.updateTaskInstance(e.jobRow.id),e.updateTaskLog(e.jobRow.id))},this.refreshInterval))},updateTaskInstance:function(e){var t=this;Object(r["d"])(e).then(function(a){t.jobRow=a,t.tasktitle="任务详情: "+a.name,t.jobRow.start_way="API调用",t.jobRow.status=t.formatStatus("","",a.status),t.jobRow.start_time=t.formatDateTime("","",a.start_time),t.jobRow.end_time=t.formatDateTime("","",a.end_time),t.jobRow.total_time=a.total_time,t.jobRow.is_finished=a.is_finished,t.updateTaskLog(e)})},updateTaskLog:function(e){var t=this;Object(r["f"])(this.jobRow.id).then(function(e){t.jobInstanceLog="",t.jobInstanceData={success:[],failure:[]};var a=!0,s=!1,n=void 0;try{for(var l,r=d()(e);!(a=(l=r.next()).done);a=!0){var o=l.value;if(!0===o.is_finished){var i=!0,c=!1,u=void 0;try{for(var b,h=d()(o.step_results);!(i=(b=h.next()).done);i=!0){var f=b.value;9===f.ip_status?t.jobInstanceData.success=t.jobInstanceData.success.concat(f.ip_logs):t.jobInstanceData.failure=t.jobInstanceData.failure.concat(f.ip_logs)}}catch(p){c=!0,u=p}finally{try{i||null==h.return||h.return()}finally{if(c)throw u}}}}}catch(p){s=!0,n=p}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}t.currentTotalSuccess=t.jobInstanceData.success.length,t.currentTotalFailure=t.jobInstanceData.failure.length})},show:function(e){this.jobRow=h()({},f),this.jobInstanceData={success:[],failure:[]},this.updateTaskInstance(e),this.init=!0,this.dialogVisible=!0},handleSuccessSizeChange:function(e){this.pageSizeSuccess=e},handleSuccessCurrentChange:function(e){this.currentPageSuccess=e},handleFailureSizeChange:function(e){this.pageSizeFailure=e},handleFailureCurrentChange:function(e){this.currentPageFailure=e},handleSuccessTableCurrentChange:function(e){try{this.jobInstanceLog=e.log_content}catch(t){this.jobInstanceLog=""}},handleFailureTableCurrentChange:function(e){try{this.jobInstanceLog=e.log_content}catch(t){this.jobInstanceLog=""}},formatDateTime:function(e,t,s){var n=a("c1df");return void 0!==s?n(s).format("YYYY-MM-DD HH:mm:ss"):""},formatStatus:function(e,t,a){var s="";return 1===a?s="未执行":2===a?s="正在执行":3===a?s="执行成功":4===a?s="执行失败":5===a?s="跳过":6===a?s="忽略错误":7===a?s="等待用户":8===a?s="手动结束":9===a?s="状态异常":10===a?s="步骤强制终止中":11===a?s="步骤强制终止成功":12===a&&(s="步骤强制终止失败"),s},handleDialogOpen:function(){},handleDialogClose:function(){this.$emit("dataRefresh")}}},m=p,_=a("2877"),j=Object(_["a"])(m,i,c,!1,null,"6b0bbe00",null),g=j.exports,v={name:"TaskInstance",components:{TaskDetails:g},props:{modules:{type:String,default:""},uuid:{type:String,default:""},pageSize:{type:Number,default:10},autoRefresh:{type:Boolean,default:!0},refreshInterval:{type:Number,default:6e4}},computed:Object(l["a"])({},Object(o["b"])(["name","role","currBiz"])),data:function(){return{show:!1,timeout:null,timer:null,filter_job_type_vaule:"",currentPage:1,search_value:"",type_value:"",order_value:"-id",currentTotal:0,multipleSelection:[],multipleSelectionCount:0,tableData:[],loading:!0,column_rules:{id:!0,job_name:!0,name:!0,user:!0,is_finished:!0,status:!0,create_time:!0,start_time:!0,end_time:!0,total_time:!0}}},watch:{type_value:function(e){this.currentPage=1,this.getDatas()},show:function(e){e?document.body.addEventListener("click",this.close):document.body.removeEventListener("click",this.close)},search_value:function(e,t){var a=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){a.searchChange()},300)}},created:function(){this.getDatas(),clearInterval(this.timer),this.timer=null,this.setTimer()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null},methods:{click:function(){this.show=!this.show,this.show&&this.$refs.headerSearchSelect&&this.$refs.headerSearchSelect.focus()},close:function(){this.$refs.headerSearchSelect&&this.$refs.headerSearchSelect.blur(),this.options=[],this.show=!1},setTimer:function(){var e=this;null==this.timer&&(this.timer=setInterval(function(){e.autoRefresh&&e.getDatas()},this.refreshInterval))},handleDialogClose:function(){this.hackReset=-1},sortChange:function(e,t,a){"ascending"===e.order?this.order_value=e.prop:"descending"===e.order?this.order_value="-"+e.prop:this.order_value="",this.currentPage=1,this.getDatas()},handleSelectionChange:function(e){this.multipleSelection=e,this.multipleSelectionCount=this.multipleSelection.length},getDatas:function(){var e=this;this.loading=!0,Object(r["e"])({page:this.currentPage,page_size:this.pageSize,job__bk_biz:this.currBiz,search:this.search_value,ordering:this.order_value,job__type:this.filter_job_type_vaule,job__module:this.modules,job__job_uuid:this.uuid}).then(function(t){e.currentTotal=t.count,e.tableData=t.results,e.loading=!1})},handleSizeChange:function(e){this.currentPage=1,this.pageSize=e,this.getDatas()},handleCurrentChange:function(e){this.currentPage=e,this.getDatas()},searchChange:function(){this.currentPage=1,this.getDatas()},handleOpen:function(e){this.$refs.task_details.show(e.row.id)},formatBoolean:function(e,t,a){var s="";return s=a?"是":"否",s},formatStartWay:function(e,t,a){var s="";return 1===a?s="页面启动":2===a?s="API调用":3===a&&(s="定时任务"),s},formatDateTime:function(e,t,s){var n=a("c1df");return void 0!==s?n(s).format("YYYY-MM-DD HH:mm:ss"):""},formatStatus:function(e,t,a){var s="";return 1===a?s="未执行":2===a?s="正在执行":3===a?s="执行成功":4===a?s="执行失败":5===a?s="跳过":6===a?s="忽略错误":7===a?s="等待用户":8===a?s="手动结束":9===a?s="状态异常":10===a?s="步骤强制终止中":11===a?s="步骤强制终止成功":12===a&&(s="步骤强制终止失败"),s},handleRefresh:function(){this.getDatas()},handleFilterChange:function(e){for(var t in e)"job_type"===t&&(0!==e[t].length?this.filter_job_type_vaule=e[t][0]:this.filter_job_type_vaule="");this.currentPage=1,this.getDatas()}}},w=v,y=(a("eff3"),Object(_["a"])(w,s,n,!1,null,"0dc07734",null));t["a"]=y.exports},"90a7":function(e,t,a){},eff3:function(e,t,a){"use strict";var s=a("90a7"),n=a.n(s);n.a}}]);